<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>

<body>
    <button id="send">发送通知</button>
    <button onclick="notifyMe()">Notify me!</button>

    <script>
        // request permission on page load
        document.addEventListener('DOMContentLoaded', function () {
            if (!Notification) {
                alert('Desktop notifications not available in your browser. Try Chromium.');
                return;
            }

            //   if (Notification.permission !== "granted")
            //     Notification.requestPermission();
            // });

            // function notifyMe() {
            //   if (Notification.permission !== "granted")
            //     Notification.requestPermission();
            //   else {
            //     var notification = new Notification('Notification title', {
            //       icon: 'http://cdn.sstatic.net/stackexchange/img/logos/so/so-icon.png',
            //       body: "Hey there! You've been notified!",
            //     });

            //     notification.onclick = function () {
            //       window.open("http://stackoverflow.com/a/13328397/1269037");      
            //     };

            //   }

            // }

            // var notification = null;
            // if(Notification.permission === 'granted'){
            //     // 用户允许通知
            //     console.log('用户允许通知');

            // }else if(Notification.permission === 'denied'){
            //     // 用户拒绝通知
            //     console.log('用户拒绝通知');
            // }else{
            //     // 用户还没选择，去向用户申请权限吧
            //     console.log('用户还没选择，去向用户申请权限吧');
            //     Notification.requestPermission().then(function(permission) {
            //         if(permission === 'granted'){
            //             console.log('用户允许通知');
            //         }else if(permission === 'denied'){
            //             console.log('用户拒绝通知');
            //         }
            //     });
            // }
            var send = document.querySelector('#send');
            send.onclick = function () {
                // 发送消息
                setTimeout(() => {
                    console.log('发送消息');
                    // var n = new Notification("Hi!");
                    // n.onshow = function () { 
                    // setTimeout(n.close.bind(n), 5000); 
                    // }
                    // var notification = new Notification('收到新邮件', {
                    //     body: '您总共有3封未读邮件。'
                    // });
                    // notification.onshow = function() {
                    //     console.log('msg show!');
                    // }
                    var notification = new Notification('消息通知', {
                        body: '快去查看吧',
                        // tag: 'linxin1',
                        icon: 'http://img2.imgtn.bdimg.com/it/u=1786483499,2326008885&fm=26&gp=0.jpg',
                        requireInteraction: true
                    })
                }, 1000);
            }
        })
    </script>
</body>

</html>